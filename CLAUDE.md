# CLAUDE.md - 项目 AI 上下文索引

## 项目概述

这是一个基于 Godot 4.5 引擎的"植物大战僵尸"塔防游戏项目，使用 C# 作为主要开发语言，并集成了 GDAI MCP 插件以支持 AI 辅助开发。

## 快速导航

### 核心模块
- **[.spec-workflow/](.spec-workflow/CLAUDE.md)** - Spec Workflow 系统，包含需求文档、设计文档、技术规范等模板
- **[addons/](addons/CLAUDE.md)** - Godot 插件和扩展，包含 GDAI MCP 插件
- **[.claude/](.claude/CLAUDE.md)** - Claude Code 配置和代理设置

### 项目配置
- **[project.godot](project.godot)** - Godot 项目配置文件
- **[植物大战僵尸.csproj](植物大战僵尸.csproj)** - C# 项目配置文件
- **[植物大战僵尸.sln](植物大战僵尸.sln)** - Visual Studio 解决方案文件

## 开发环境

### 基本要求
- Godot Engine 4.5+
- .NET 8.0 (Android 平台需要 .NET 9.0)
- GDAI MCP Plugin v0.2.6

### 项目设置
- 项目名称：植物大战僵尸
- 程序集名称：植物大战僵尸
- 目标框架：net8.0
- 动态加载：已启用

### 开发工具链

**启动 Godot 编辑器：**
```bash
# 使用命令行启动项目
godot --path /Users/zzk/Dev/测试AI能力/植物大战僵尸
```

**编译和运行：**
- 在 Godot 编辑器中按 F5 运行项目
- 按 F6 运行当前场景
- 使用 Godot 编辑器进行项目管理

**C# 开发：**
- 项目支持 C# 脚本开发
- 可使用 Visual Studio Code 或 Rider 作为外部 IDE
- 项目文件：`植物大战僵尸.csproj`

## 项目架构

### 核心组件

**GDAI MCP 集成：**
- 插件位置：`addons/gdai-mcp-plugin-godot/`
- 运行时自动加载：`GDAIMCPRuntime`
- 支持 AI 辅助的场景创建、节点操作、脚本编写等功能

**Spec Workflow 系统：**
- 位置：`.spec-workflow/`
- 包含需求文档、设计文档、技术规范等模板
- 支持系统化的功能开发流程

### 文件结构约定

**C# 脚本：**
- 使用 `.cs` 扩展名
- 遵循 C# 命名约定
- 建议将脚本组织在适当的命名空间中

**场景文件：**
- 使用 `.tscn` 扩展名
- 场景命名应使用中文或清晰的英文描述

**资源文件：**
- 使用 `.tres` 扩展名
- 图标和纹理文件存放在项目根目录或专门的资源文件夹中

## 开发最佳实践

### 代码组织
- 每个脚本文件应保持单一职责
- 使用适当的访问修饰符（public, private, internal）
- 遵循 SOLID 原则

### 场景管理
- 合理组织场景树结构
- 使用节点引用而非硬编码路径
- 利用 Godot 的信号系统实现松耦合

### 性能优化
- 在 `_Ready()` 中进行一次性初始化
- 使用 `_Process()` 进行需要每帧更新的逻辑
- 避免在循环中进行不必要的内存分配

## 常用开发任务

### 创建新场景
1. 在 Godot 编辑器中使用场景树面板
2. 保存场景到适当位置
3. 添加相应的脚本文件

### 添加 C# 脚本
1. 创建 `.cs` 文件
2. 继承适当的 Godot 节点类（如 `Node2D`, `Control`, `Node3D` 等）
3. 添加 `[Tool]` 属性以支持编辑器内编辑

### 调试和测试
- 使用 Godot 的调试器进行断点调试
- 利用 `GD.Print()` 输出调试信息
- 在编辑器中测试单个场景功能

## AI 辅助开发

通过 GDAI MCP 插件，可以：
- 通过自然语言创建场景和节点
- 自动生成脚本代码
- 调试脚本错误和查看日志
- 搜索项目文件和资源

## AI 上下文结构

此索引作为项目 AI 上下文的入口点，详细的模块级文档请参考：
- 根级文档（当前文件）- 项目概览和导航
- 模块级文档（各子目录下的 CLAUDE.md）- 详细的模块说明和使用指南

## 注意事项

- 插件文件 `addons/gdai-mcp-plugin-godot/` 不应提交到公共代码库
- 项目支持跨平台开发，注意平台特定配置
- 开发时保持 Godot 编辑器和 MCP 客户端的连接状态

## 更新日志

- **2024-11-23** - 初始化项目 AI 上下文，生成根级索引和模块级文档